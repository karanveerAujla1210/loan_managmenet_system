# ADD THIS SNIPPET into backend/server.js (after app initialization and cookie-parser):
const csrf = require('csurf');
const cookieParser = require('cookie-parser');

app.use(cookieParser(process.env.COOKIE_SECRET || 'fallback_cookie_secret'));
app.use(csrf({ cookie: { httpOnly: true, secure: process.env.NODE_ENV === 'production', sameSite: 'Lax' } }));

// CSRF token endpoint for clients
app.get('/api/csrf-token', (req, res) => {
  res.json({ csrfToken: req.csrfToken() });
});
